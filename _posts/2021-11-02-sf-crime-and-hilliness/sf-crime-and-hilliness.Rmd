---
title: "San Francisco Crime and Hilliness"
description: |
  Anyone who has been to San Francisco is familiar with the hilly terrain and roads that seem to climb into the clouds. But does this topography have an effect on where car break-ins happen? I wanted to take a look at this relationship with visualizations and a linear regression analysis.
author:
  - name: Alex Clippinger
    url: {}
date: 2021-11-02
output:
  distill::distill_article:
    self_contained: false
    code_folding: true
    toc: true              
    toc_float: true
bibliography: bibliography.bib
preview: images/crime_hills.jpg
categories: 
  - R
  - GIS
---

<figure>

<img src="./images/san-francisco-hills.jpg" alt="A particularly steep San Francisco street" style="height: 534px; width:800px;"/>

<figcaption>

That is one steep street!

</figcaption>

</figure>

## Research Question

My research question is: "What is the relationship between topography and car break-ins in San Francisco?

### Background

In April 2021, Young-An Kim & James C. Wo published [Topography and crime in place: The effects of elevation, slope, and betweenness in San Francisco street segments](https://www.tandfonline.com/doi/full/10.1080/07352166.2021.1901591). Their study provides a robust regression analysis on the effects of elevation, slope, and "hilliness" on crime, controlling for socio-demographic characteristics @sfcrime. **My analysis will focus only on car break-ins rather than all crime reports**, as I believe that these crimes will have an even more pronounced relationship with topography.

## Data Collection

### Important Variables

- **dependent variable**: crime (specifically car break-ins) 

- **independent variables**: slope and elevation 

- **control variables**: median income by census block

### Data Sources

All data for this analysis was retrieved from the [San Francisco Open Data Portal](https://datasf.org/opendata/).

- [crime](https://data.sfgov.org/Public-Safety/Police-Department-Incident-Reports-2018-to-Present/wg3w-h783)
- [elevation contours](https://data.sfgov.org/Energy-and-Environment/Elevation-Contours/rnbg-2qxw)
- [areas with high slope](https://data.sfgov.org/Geographic-Locations-and-Boundaries/Slopes-of-20-Or-Greater/3vv2-nvev)

- [streets](https://data.sfgov.org/Geographic-Locations-and-Boundaries/Streets-Active-and-Retired/3psu-pn9h)
- [census block](https://data.sfgov.org/Geographic-Locations-and-Boundaries/Census-2010-Blocks-for-San-Francisco/2uzy-uv2r)

## Analysis Plan

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE, 
                      warning = FALSE, 
                      include = TRUE)

library(sf)
library(tidyverse)
#library(raster)
```

```{r load data, include = FALSE}
# EPSG:7132 - NAD83(2011) / San Francisco CS13 (ftUS) - Projected
crimes <- st_read("data/crime_reports_2018_present/crime_reports_2018_present.shp", query = "SELECT date_incid FROM crime_reports_2018_present WHERE incident_2 = 'Motor Vehicle Theft'") %>% 
  st_transform(crs = st_crs(7132))

contours <- st_read("data/contours/contours.shp") %>% 
  st_transform(crs = st_crs(7132))

slopes_over_20 <- st_read("data/slopes_over_20/slopes_over_20.shp", query = "SELECT objectid as slope_over_20 FROM slopes_over_20") %>% 
  st_transform(crs = st_crs(7132))
```

```{r merge data}
# Find index of nearest contour to each crime
elev <- st_nearest_feature(x = crimes, y = contours)

# Add elevation and binary slope columns
crimes <- crimes %>% 
  mutate(elev = contours[elev,]$elevation) %>% 
  st_join(y = slopes_over_20, join = st_within)
```

## Results
  





